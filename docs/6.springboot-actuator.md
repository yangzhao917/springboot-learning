# ç¬¬å…­ç« ï¼šSpring Boot Actuatorï¼šåº”ç”¨ç›‘æ§ä¸ç®¡ç†

> æ‘˜è¦ï¼ˆTL;DRï¼‰
> - ç›®æ ‡ï¼šæŒæ¡ Spring Boot Actuator çš„æ ¸å¿ƒåŠŸèƒ½å’Œä½¿ç”¨æ–¹æ³•
> - å­¦ä¼šï¼šå¥åº·æ£€æŸ¥ã€æ€§èƒ½ç›‘æ§ã€åŠ¨æ€é…ç½®ã€è‡ªå®šä¹‰ç«¯ç‚¹
> - æ”¶è·ï¼šæå‡åº”ç”¨å¯è§‚å¯Ÿæ€§ï¼Œå®ç°ç”Ÿäº§å°±ç»ªçš„ç›‘æ§ä½“ç³»

## ğŸ“š ç›®å½•

- [å†…å®¹æ¦‚è§ˆ](#å†…å®¹æ¦‚è§ˆ)
- [6.1 Actuator æ˜¯ä»€ä¹ˆï¼Ÿ](#61-actuator-æ˜¯ä»€ä¹ˆ)
- [6.2 å¿«é€Ÿé›†æˆ Actuator](#62-å¿«é€Ÿé›†æˆ-actuator)
- [6.3 æ ¸å¿ƒç«¯ç‚¹è¯¦è§£](#63-æ ¸å¿ƒç«¯ç‚¹è¯¦è§£)
  - [6.3.1 å¥åº·æ£€æŸ¥ (`/health`)](#631-å¥åº·æ£€æŸ¥-health)
  - [6.3.2 åº”ç”¨ä¿¡æ¯ (`/info`)](#632-åº”ç”¨ä¿¡æ¯-info)
  - [6.3.3 æ€§èƒ½æŒ‡æ ‡ (`/metrics`)](#633-æ€§èƒ½æŒ‡æ ‡-metrics)
  - [6.3.4 ç¯å¢ƒå±æ€§ (`/env`)](#634-ç¯å¢ƒå±æ€§-env)
  - [6.3.5 Bean ä¿¡æ¯ (`/beans`)](#635-bean-ä¿¡æ¯-beans)
  - [6.3.6 æ—¥å¿—ç®¡ç† (`/loggers`)](#636-æ—¥å¿—ç®¡ç†-loggers)
  - [6.3.7 å…¶ä»–é‡è¦ç«¯ç‚¹](#637-å…¶ä»–é‡è¦ç«¯ç‚¹)
- [6.4 é…ç½®ä¸å®‰å…¨](#64-é…ç½®ä¸å®‰å…¨)
  - [6.4.1 æš´éœ²ç«¯ç‚¹](#641-æš´éœ²ç«¯ç‚¹)
  - [6.4.2 ä¿æŠ¤ç«¯ç‚¹](#642-ä¿æŠ¤ç«¯ç‚¹)
- [6.5 è‡ªå®šä¹‰ Actuator](#65-è‡ªå®šä¹‰-actuator)
  - [6.5.1 è‡ªå®šä¹‰å¥åº·æŒ‡ç¤ºå™¨](#651-è‡ªå®šä¹‰å¥åº·æŒ‡ç¤ºå™¨)
  - [6.5.2 è‡ªå®šä¹‰ä¿¡æ¯ç«¯ç‚¹](#652-è‡ªå®šä¹‰ä¿¡æ¯ç«¯ç‚¹)
  - [6.5.3 åˆ›å»ºè‡ªå®šä¹‰ç«¯ç‚¹](#653-åˆ›å»ºè‡ªå®šä¹‰ç«¯ç‚¹)
- [6.6 ä¸ç›‘æ§ç³»ç»Ÿé›†æˆ](#66-ä¸ç›‘æ§ç³»ç»Ÿé›†æˆ)
- [6.7 å¯è§†åŒ–ç›‘æ§ï¼šé›†æˆ Spring Boot Admin](#67-å¯è§†åŒ–ç›‘æ§é›†æˆ-spring-boot-admin)
- [6.8 æœ€ä½³å®è·µ](#68-æœ€ä½³å®è·µ)
- [6.9 æ€»ç»“](#69-æ€»ç»“)

---

## å†…å®¹æ¦‚è§ˆ

æœ¬æ–‡æ¡£å…¨é¢ä»‹ç»Spring Boot Actuatorç›‘æ§åŠŸèƒ½ï¼Œæ¶µç›–ä»¥ä¸‹æ ¸å¿ƒå†…å®¹ï¼š

### ğŸ“š ä¸»è¦å†…å®¹

#### ç¬¬ä¸€éƒ¨åˆ†ï¼šActuatoråŸºç¡€ï¼ˆå…¥é—¨ï¼‰
- **Actuatoræ¦‚å¿µ**ï¼šä»€ä¹ˆæ˜¯åº”ç”¨ç›‘æ§ï¼Œä¸ºä»€ä¹ˆéœ€è¦Actuator
- **æ ¸å¿ƒä»·å€¼**ï¼šåº”ç”¨ç›‘æ§ã€é…ç½®æŸ¥çœ‹ã€åŠ¨æ€ç®¡ç†ã€é—®é¢˜æ’æŸ¥

#### ç¬¬äºŒéƒ¨åˆ†ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆè¿›é˜¶ï¼‰
- **å¿«é€Ÿé›†æˆ**ï¼šæ·»åŠ ä¾èµ–å¹¶å¯ç”¨Actuator
- **æ ¸å¿ƒç«¯ç‚¹**ï¼šå¥åº·æ£€æŸ¥ã€åº”ç”¨ä¿¡æ¯ã€æ€§èƒ½æŒ‡æ ‡ã€ç¯å¢ƒå±æ€§ç­‰
- **é…ç½®ç®¡ç†**ï¼šç«¯ç‚¹æš´éœ²æ§åˆ¶ã€å®‰å…¨ä¿æŠ¤

#### ç¬¬ä¸‰éƒ¨åˆ†ï¼šè‡ªå®šä¹‰æ‰©å±•ï¼ˆå®æˆ˜ï¼‰
- **å¥åº·æŒ‡ç¤ºå™¨**ï¼šè‡ªå®šä¹‰å¥åº·æ£€æŸ¥é€»è¾‘
- **ä¿¡æ¯ç«¯ç‚¹**ï¼šæ‰©å±•åº”ç”¨ä¿¡æ¯å†…å®¹
- **è‡ªå®šä¹‰ç«¯ç‚¹**ï¼šåˆ›å»ºä¸šåŠ¡ç‰¹å®šçš„ç›‘æ§ç«¯ç‚¹

#### ç¬¬å››éƒ¨åˆ†ï¼šç›‘æ§é›†æˆï¼ˆæ·±å…¥ï¼‰
- **å¤–éƒ¨ç³»ç»Ÿé›†æˆ**ï¼šPrometheusã€Grafanaç­‰ç›‘æ§ç³»ç»Ÿ
- **å¯è§†åŒ–ç›‘æ§**ï¼šSpring Boot Adminé›†æˆ
- **æœ€ä½³å®è·µ**ï¼šç”Ÿäº§ç¯å¢ƒä½¿ç”¨å»ºè®®

### ğŸ”§ æ ¸å¿ƒç«¯ç‚¹

| ç«¯ç‚¹ | ä½œç”¨ | è¯´æ˜ |
|------|------|------|
| `/health` | å¥åº·æ£€æŸ¥ | åº”ç”¨åŠä¾èµ–æœåŠ¡çš„å¥åº·çŠ¶æ€ |
| `/info` | åº”ç”¨ä¿¡æ¯ | ç‰ˆæœ¬ã€æ„å»ºä¿¡æ¯ç­‰è‡ªå®šä¹‰æ•°æ® |
| `/metrics` | æ€§èƒ½æŒ‡æ ‡ | JVMã€HTTPè¯·æ±‚ç­‰æ€§èƒ½æ•°æ® |
| `/env` | ç¯å¢ƒå±æ€§ | é…ç½®å±æ€§å’Œç¯å¢ƒå˜é‡ |
| `/loggers` | æ—¥å¿—ç®¡ç† | åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ« |
| `/beans` | Beanä¿¡æ¯ | Springå®¹å™¨ä¸­çš„Beanè¯¦æƒ… |

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **å¼€ç®±å³ç”¨**ï¼šç®€å•é›†æˆå³å¯è·å¾—ä¸°å¯Œç›‘æ§åŠŸèƒ½
- **é«˜åº¦å¯æ‰©å±•**ï¼šæ”¯æŒè‡ªå®šä¹‰å¥åº·æ£€æŸ¥å’Œç›‘æ§ç«¯ç‚¹
- **å®‰å…¨å¯æ§**ï¼šçµæ´»çš„ç«¯ç‚¹æš´éœ²å’Œè®¿é—®æ§åˆ¶
- **ç”Ÿæ€é›†æˆ**ï¼šä¸ä¸»æµç›‘æ§ç³»ç»Ÿæ— ç¼é›†æˆ

---

## 6.1 Actuator æ˜¯ä»€ä¹ˆï¼Ÿ

### ğŸ¤” ä»€ä¹ˆæ˜¯Actuatorï¼Ÿ

**Spring Boot Actuator**æ˜¯Spring Bootæä¾›çš„å¼ºå¤§åŠŸèƒ½ï¼Œç”¨äºåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç›‘æ§å’Œç®¡ç†æ‚¨çš„åº”ç”¨ç¨‹åºã€‚å®ƒé€šè¿‡ä¸€ç»„å†…ç½®çš„HTTPç«¯ç‚¹ï¼ˆEndpointsï¼‰æˆ–JMX MBeanï¼Œè®©æ‚¨å¯ä»¥è½»æ¾åœ°è·å–åº”ç”¨çš„å¥åº·çŠ¶å†µã€æ€§èƒ½æŒ‡æ ‡ã€é…ç½®ä¿¡æ¯ã€çº¿ç¨‹çŠ¶æ€ç­‰å…³é”®ä¿¡æ¯ï¼Œç”šè‡³å¯ä»¥åŠ¨æ€è°ƒæ•´æ—¥å¿—çº§åˆ«æˆ–ä¼˜é›…åœ°å…³é—­åº”ç”¨ã€‚

### ğŸ’¡ ç”Ÿæ´»ä¸­çš„æ¯”å–»

æƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨çš„æ±½è½¦ä»ªè¡¨ç›˜ã€‚å®ƒå®æ—¶æ˜¾ç¤ºäº†è½¦é€Ÿã€æ²¹é‡ã€å‘åŠ¨æœºæ¸©åº¦ç­‰å…³é”®ä¿¡æ¯ï¼Œè®©æ‚¨éšæ—¶äº†è§£æ±½è½¦çš„è¿è¡ŒçŠ¶æ€ï¼Œå¹¶åœ¨å‡ºç°é—®é¢˜æ—¶åŠæ—¶é¢„è­¦ã€‚

**Spring Boot Actuatorå°±æ˜¯æ‚¨åº”ç”¨ç¨‹åºçš„"ä»ªè¡¨ç›˜"**ã€‚

å®ƒæ˜¯ä¸€ä¸ªSpring Bootçš„å­é¡¹ç›®ï¼Œæä¾›äº†ä¸€ç³»åˆ—"ç”Ÿäº§å°±ç»ª"çš„åŠŸèƒ½ï¼Œå¸®åŠ©æ‚¨ç›‘æ§å’Œç®¡ç†æ­£åœ¨è¿è¡Œçš„Spring Bootåº”ç”¨ã€‚è¿™äº›åŠŸèƒ½é€šè¿‡æš´éœ²ä¸€ç³»åˆ—çš„**ç«¯ç‚¹ï¼ˆEndpointsï¼‰**æ¥å®ç°ï¼Œæ‚¨å¯ä»¥é€šè¿‡HTTPæˆ–JMXæ¥è®¿é—®å®ƒä»¬ã€‚

### ğŸ¯ Actuatorçš„æ ¸å¿ƒä»·å€¼

- **åº”ç”¨ç›‘æ§**ï¼šå®æ—¶æŸ¥çœ‹åº”ç”¨çš„å¥åº·çŠ¶å†µã€CPUä½¿ç”¨ç‡ã€å†…å­˜ã€çº¿ç¨‹æ± çŠ¶æ€ç­‰
- **é…ç½®æŸ¥çœ‹**ï¼šäº†è§£å½“å‰åº”ç”¨åŠ è½½äº†å“ªäº›é…ç½®ï¼Œä»¥åŠSpring Bootçš„è‡ªåŠ¨é…ç½®å†³ç­–
- **åŠ¨æ€ç®¡ç†**ï¼šåœ¨ä¸é‡å¯åº”ç”¨çš„æƒ…å†µä¸‹ï¼ŒåŠ¨æ€ä¿®æ”¹æ—¥å¿—çº§åˆ«ï¼Œæˆ–è€…ä¼˜é›…åœ°å…³é—­åº”ç”¨
- **é—®é¢˜æ’æŸ¥**ï¼šè·å–çº¿ç¨‹è½¬å‚¨ï¼ˆThread Dumpï¼‰å’Œå †è½¬å‚¨ï¼ˆHeap Dumpï¼‰ï¼Œå¸®åŠ©åˆ†æçº¿ä¸Šé—®é¢˜
- **é›†æˆå¤–éƒ¨ç³»ç»Ÿ**ï¼šå¯ä»¥ä¸Prometheusã€Grafanaã€DataDogç­‰ä¸»æµç›‘æ§ç³»ç»Ÿæ— ç¼é›†æˆï¼Œå®ç°ç»Ÿä¸€çš„ç›‘æ§å‘Šè­¦å¹³å°

åŸºæœ¬ä¸Šï¼Œä»»ä½•éœ€è¦æŠ•å…¥ç”Ÿäº§ç¯å¢ƒçš„Spring Bootåº”ç”¨ï¼Œéƒ½åº”è¯¥åŒ…å«Actuatorã€‚

---

## 6.2 å¿«é€Ÿé›†æˆ Actuator

### ğŸ› ï¸ é›†æˆæ­¥éª¤

åœ¨Spring Booté¡¹ç›®ä¸­é›†æˆActuatoréå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€æ­¥å³å¯ã€‚

#### æ­¥éª¤1ï¼šæ·»åŠ Mavenä¾èµ–

åœ¨æ‚¨çš„[pom.xml](file:///Users/yangzhao/Projects/IdeaProjects/springboot-learning/pom.xml)æ–‡ä»¶ä¸­ï¼Œæ·»åŠ `spring-boot-starter-actuator`ä¾èµ–ï¼š

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-actuator</artifactId>
</dependency>
```

å°±æ˜¯è¿™æ ·ï¼ä¸€æ—¦æ·»åŠ äº†è¿™ä¸ªä¾èµ–å¹¶é‡æ–°å¯åŠ¨åº”ç”¨ï¼ŒActuatorå°±ä¼šè‡ªåŠ¨é…ç½®å¹¶å¼€å§‹å·¥ä½œã€‚

#### æ­¥éª¤2ï¼šè®¿é—®é»˜è®¤ç«¯ç‚¹

é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡ºäºå®‰å…¨è€ƒè™‘ï¼ŒSpring Boot 2.xåªä¼šæš´éœ²`/actuator/health`å’Œ`/actuator/info`ä¸¤ä¸ªç«¯ç‚¹ã€‚

å¯åŠ¨æ‚¨çš„åº”ç”¨åï¼Œå¯ä»¥å°è¯•è®¿é—®ï¼š

- `http://localhost:8080/actuator/health`

æ‚¨åº”è¯¥ä¼šçœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„JSONå“åº”ï¼Œè¡¨ç¤ºåº”ç”¨å½“å‰æ˜¯"å¥åº·"çš„ï¼š

```json
{
  "status": "UP"
}
```

- `http://localhost:8080/actuator/info`

é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªç«¯ç‚¹è¿”å›ä¸€ä¸ªç©ºçš„JSONå¯¹è±¡`{}`ã€‚æˆ‘ä»¬å°†åœ¨åç»­ç« èŠ‚å­¦ä¹ å¦‚ä½•å‘å…¶ä¸­æ·»åŠ è‡ªå®šä¹‰ä¿¡æ¯ã€‚

> **æ³¨æ„**ï¼šæ‰€æœ‰Actuatorçš„ç«¯ç‚¹éƒ½é»˜è®¤å¸¦æœ‰ä¸€ä¸ª`/actuator`çš„å‰ç¼€ï¼Œè¿™ä¸ªå‰ç¼€ä¹Ÿæ˜¯å¯ä»¥è‡ªå®šä¹‰çš„ã€‚

---

## 6.3 æ ¸å¿ƒç«¯ç‚¹è¯¦è§£

Actuatoræä¾›äº†å¤§é‡å¼€ç®±å³ç”¨çš„ç«¯ç‚¹ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›æœ€å¸¸ç”¨å’Œé‡è¦çš„ç«¯ç‚¹ã€‚

**é¦–å…ˆï¼Œä¸ºäº†æ–¹ä¾¿å­¦ä¹ å’Œæµ‹è¯•ï¼Œæˆ‘ä»¬éœ€è¦æš´éœ²æ‰€æœ‰ç«¯ç‚¹ã€‚**åœ¨`application.properties`æˆ–`application.yml`ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

**`application.properties`:**
```properties
management.endpoints.web.exposure.include=*
```

**`application.yml`:**
```yaml
management:
  endpoints:
    web:
      exposure:
        include: "*"
```

> **è­¦å‘Š**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæš´éœ²æ‰€æœ‰ç«¯ç‚¹æ˜¯**æå…¶å±é™©**çš„è¡Œä¸ºã€‚è¯·åŠ¡å¿…åœ¨åç»­ç« èŠ‚å­¦ä¹ å¦‚ä½•ä¿æŠ¤å®ƒä»¬ã€‚

ç°åœ¨ï¼Œé‡å¯åº”ç”¨ï¼Œè®©æˆ‘ä»¬æ¥æ¢ç´¢è¿™äº›å¼ºå¤§çš„ç«¯ç‚¹ã€‚

### 6.3.1 å¥åº·æ£€æŸ¥ (`/health`)

è¿™æ˜¯æœ€é‡è¦çš„ç«¯ç‚¹ï¼Œç”¨äºç›‘æ§åº”ç”¨çš„å¥åº·çŠ¶å†µã€‚å®ƒå¯ä»¥è¢«Kubernetesã€Consulç­‰æœåŠ¡å‘ç°ç»„ä»¶æˆ–è´Ÿè½½å‡è¡¡å™¨ç”¨æ¥åˆ¤æ–­åº”ç”¨å®ä¾‹æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚

é»˜è®¤åªæ˜¾ç¤ºæ€»ä½“çŠ¶æ€ã€‚è¦æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€ç£ç›˜ç©ºé—´ç­‰ï¼‰ï¼Œéœ€é…ç½®ï¼š

**`application.properties`:**
```properties
management.endpoint.health.show-details=always
```

ç°åœ¨è®¿é—®`/actuator/health`ï¼Œæ‚¨ä¼šçœ‹åˆ°æ›´ä¸°å¯Œçš„ä¿¡æ¯ï¼š
```json
{
  "status": "UP",
  "components": {
    "db": {
      "status": "UP",
      "details": {
        "database": "MySQL",
        "validationQuery": "SELECT 1"
      }
    },
    "diskSpace": {
      "status": "UP",
      "details": {
        "total": 499963174912,
        "free": 107374182400,
        "threshold": 10485760
      }
    },
    "redis": {
      "status": "UP",
      "details": {
        "version": "6.2.6"
      }
    }
  }
}
```

### 6.3.2 åº”ç”¨ä¿¡æ¯ (`/info`)

ç”¨äºå±•ç¤ºåº”ç”¨çš„è‡ªå®šä¹‰ä¿¡æ¯ï¼Œå¦‚ç‰ˆæœ¬å·ã€æ„å»ºæ—¶é—´ã€Gitæäº¤ä¿¡æ¯ç­‰ã€‚

**æ–¹æ³•ä¸€ï¼šåœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ **

```properties
info.app.name=Spring Boot Learning Project
info.app.version=1.0.0
info.app.description=A project for learning Spring Boot
```

è®¿é—®`/actuator/info`ï¼š
```json
{
  "app": {
    "name": "Spring Boot Learning Project",
    "version": "1.0.0",
    "description": "A project for learning Spring Boot"
  }
}
```

**æ–¹æ³•äºŒï¼šé›†æˆæ„å»ºä¿¡æ¯ï¼ˆæ¨èï¼‰**

åœ¨[pom.xml](file:///Users/yangzhao/Projects/IdeaProjects/springboot-learning/pom.xml)çš„`spring-boot-maven-plugin`ä¸­æ·»åŠ `build-info`ç›®æ ‡ï¼š
```xml
<plugin>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-maven-plugin</artifactId>
    <executions>
        <execution>
            <goals>
                <goal>build-info</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```
é‡æ–°æ„å»ºé¡¹ç›®ï¼ˆ`mvn clean package`ï¼‰åï¼Œ`/actuator/info`ä¼šè‡ªåŠ¨åŒ…å«`META-INF/build-info.properties`çš„å†…å®¹ã€‚

### 6.3.3 æ€§èƒ½æŒ‡æ ‡ (`/metrics`)

è¿™æ˜¯ç›‘æ§çš„å®åº“ï¼Œæä¾›äº†å¤§é‡å…³äºåº”ç”¨æ€§èƒ½çš„æŒ‡æ ‡ï¼Œå¦‚JVMå†…å­˜ä½¿ç”¨ã€CPUä½¿ç”¨ç‡ã€HTTPè¯·æ±‚ç»Ÿè®¡ã€çº¿ç¨‹æ•°ç­‰ã€‚

- **è®¿é—®`/actuator/metrics`**ï¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æŒ‡æ ‡åç§°ã€‚
- **è®¿é—®`/actuator/metrics/{metric.name}`**ï¼šæŸ¥çœ‹ç‰¹å®šæŒ‡æ ‡çš„è¯¦ç»†ä¿¡æ¯ã€‚

ä¾‹å¦‚ï¼ŒæŸ¥çœ‹JVMå†…å­˜ä½¿ç”¨æƒ…å†µï¼š
`GET /actuator/metrics/jvm.memory.used`

```json
{
  "name": "jvm.memory.used",
  "description": "The amount of used memory",
  "baseUnit": "bytes",
  "measurements": [
    {
      "statistic": "VALUE",
      "value": 2.804408E8
    }
  ],
  "availableTags": [
    { "tag": "area", "values": ["heap", "nonheap"] },
    { "tag": "id", "values": ["G1 Old Gen", "G1 Survivor Space", ...] }
  ]
}
```
æ‚¨è¿˜å¯ä»¥é€šè¿‡æ ‡ç­¾è¿›è¡Œç­›é€‰ï¼Œä¾‹å¦‚ï¼š
`GET /actuator/metrics/jvm.memory.used?tag=area:heap`

### 6.3.4 ç¯å¢ƒå±æ€§ (`/env`)

æ˜¾ç¤ºå½“å‰åº”ç”¨çš„æ‰€æœ‰ç¯å¢ƒå±æ€§ï¼ŒåŒ…æ‹¬é…ç½®æ–‡ä»¶ã€ç³»ç»Ÿå±æ€§ã€ç¯å¢ƒå˜é‡ç­‰ã€‚

- **è®¿é—®`/actuator/env`**ï¼šæŸ¥çœ‹æ‰€æœ‰å±æ€§æºåŠå…¶å±æ€§ã€‚
- **è®¿é—®`/actuator/env/{property.name}`**ï¼šè·å–å•ä¸ªå±æ€§çš„å€¼ã€‚

è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„è¯Šæ–­å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æ‚¨æ£€æŸ¥æŸä¸ªé…ç½®æ˜¯å¦è¢«æ­£ç¡®åŠ è½½ã€‚å‡ºäºå®‰å…¨åŸå› ï¼Œå¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ä¼šè¢«è‡ªåŠ¨è„±æ•ï¼Œæ˜¾ç¤ºä¸º`******`ã€‚

### 6.3.5 Bean ä¿¡æ¯ (`/beans`)

åˆ—å‡ºSpringå®¹å™¨ä¸­æ‰€æœ‰çš„BeanåŠå…¶ä¾èµ–å…³ç³»ã€‚
`GET /actuator/beans`

è¿”å›çš„JSONä¼šéå¸¸åºå¤§ï¼Œä½†å¯¹äºç†è§£Springçš„è‡ªåŠ¨é…ç½®å’Œæ’æŸ¥Beanå†²çªé—®é¢˜éå¸¸æœ‰ç”¨ã€‚

### 6.3.6 æ—¥å¿—ç®¡ç† (`/loggers`)

åŠ¨æ€æŸ¥çœ‹å’Œä¿®æ”¹åº”ç”¨çš„æ—¥å¿—çº§åˆ«ï¼Œæ— éœ€é‡å¯ï¼

- **`GET /actuator/loggers`**ï¼šæŸ¥çœ‹æ‰€æœ‰loggerçš„é…ç½®çº§åˆ«ã€‚
- **`GET /actuator/loggers/{logger.name}`**ï¼šæŸ¥çœ‹ç‰¹å®šloggerçš„çº§åˆ«ã€‚
- **`POST /actuator/loggers/{logger.name}`**ï¼šä¿®æ”¹ç‰¹å®šloggerçš„çº§åˆ«ã€‚

ä¾‹å¦‚ï¼Œä¸´æ—¶å°†`org.example`åŒ…çš„æ—¥å¿—çº§åˆ«è°ƒæ•´ä¸º`DEBUG`ä»¥ä¾¿æ’æŸ¥é—®é¢˜ï¼š

`POST /actuator/loggers/org.example`
Request Body:
```json
{
  "configuredLevel": "DEBUG"
}
```
å½“é—®é¢˜æ’æŸ¥å®Œæ¯•åï¼Œå¯ä»¥å°†å…¶è®¾ç½®å›`INFO`æˆ–`null`ï¼ˆç»§æ‰¿çˆ¶çº§é…ç½®ï¼‰ã€‚

### 6.3.7 å…¶ä»–é‡è¦ç«¯ç‚¹

- **`/threaddump`**: è·å–åº”ç”¨çš„çº¿ç¨‹è½¬å‚¨ï¼Œç”¨äºåˆ†ææ­»é”ã€æ€§èƒ½ç“¶é¢ˆç­‰é—®é¢˜ã€‚
- **`/heapdump`**: ä¸‹è½½åº”ç”¨çš„å †è½¬å‚¨æ–‡ä»¶ï¼ˆ`.hprof`ï¼‰ï¼Œç”¨äºåˆ†æå†…å­˜æ³„æ¼ã€‚
- **`/mappings`**: æ˜¾ç¤ºæ‰€æœ‰`@RequestMapping`çš„è·¯å¾„æ˜ å°„å…³ç³»ã€‚
- **`/shutdown`**: ä¼˜é›…åœ°å…³é—­åº”ç”¨ç¨‹åºï¼ˆé»˜è®¤ç¦ç”¨ï¼‰ã€‚

---

## 6.4 é…ç½®ä¸å®‰å…¨

### 6.4.1 æš´éœ²ç«¯ç‚¹

å¦‚å‰æ‰€è¿°ï¼Œé€šè¿‡`management.endpoints.web.exposure.include`æ¥æ§åˆ¶é€šè¿‡HTTPæš´éœ²å“ªäº›ç«¯ç‚¹ã€‚

- `include: "*"`: æš´éœ²æ‰€æœ‰ï¼ˆé™¤é»˜è®¤ç¦ç”¨çš„`shutdown`ï¼‰ã€‚
- `include: "health,info,metrics"`: åªæš´éœ²æŒ‡å®šçš„ç«¯ç‚¹ã€‚
- `exclude: "env,beans"`: æš´éœ²æ‰€æœ‰ï¼Œä½†æ’é™¤æŒ‡å®šçš„ç«¯ç‚¹ã€‚

### 6.4.2 ä¿æŠ¤ç«¯ç‚¹

**åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç»ä¸èƒ½å°†Actuatorç«¯ç‚¹æš´éœ²åœ¨å…¬ç½‘ä¸Šï¼**

æœ€ç®€å•æœ‰æ•ˆçš„ä¿æŠ¤æ–¹å¼æ˜¯é›†æˆSpring Securityã€‚

1.  **æ·»åŠ Spring Securityä¾èµ–**
    ```xml
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-security</artifactId>
    </dependency>
    ```
2.  **é…ç½®å®‰å…¨è§„åˆ™**
    ä¸€æ—¦å¼•å…¥Spring Securityï¼Œæ‰€æœ‰ç«¯ç‚¹ï¼ˆåŒ…æ‹¬Actuatorï¼‰é»˜è®¤éƒ½ä¼šå—åˆ°ä¿æŠ¤ã€‚æ‚¨éœ€è¦é…ç½®ä¸€ä¸ªå®‰å…¨ç­–ç•¥ï¼Œä¾‹å¦‚ï¼Œåªå…è®¸æ‹¥æœ‰ç‰¹å®šè§’è‰²çš„ç®¡ç†å‘˜è®¿é—®Actuatorç«¯ç‚¹ã€‚

    ä¸€ä¸ªç®€å•çš„é…ç½®ç¤ºä¾‹ï¼š
    ```java
    @Configuration
    public class SecurityConfig extends WebSecurityConfigurerAdapter {
        @Override
        protected void configure(HttpSecurity http) throws Exception {
            http.authorizeRequests()
                .requestMatchers(EndpointRequest.to("health", "info")).permitAll() // å…è®¸æ‰€æœ‰äººè®¿é—® health å’Œ info
                .requestMatchers(EndpointRequest.toAnyEndpoint()).hasRole("ADMIN") // å…¶ä»– Actuator ç«¯ç‚¹éœ€è¦ ADMIN è§’è‰²
                .antMatchers("/**").permitAll() // åº”ç”¨çš„å…¶ä»– URL å…è®¸è®¿é—®
                .and()
            .httpBasic(); // ä½¿ç”¨ HTTP Basic è®¤è¯
        }
    }
    ```
    åŒæ—¶ï¼Œæ‚¨éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªç®¡ç†å‘˜ç”¨æˆ·ï¼š
    ```properties
    spring.security.user.name=admin
    spring.security.user.password=your-strong-password
    spring.security.user.roles=ADMIN
    ```

---

## 6.5 è‡ªå®šä¹‰ Actuator

Actuatorçš„å¼ºå¤§ä¹‹å¤„ä¸ä»…åœ¨äºå…¶å¼€ç®±å³ç”¨çš„åŠŸèƒ½ï¼Œæ›´åœ¨äºå…¶é«˜åº¦çš„å¯æ‰©å±•æ€§ã€‚ä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„å¥åº·æŒ‡ç¤ºå™¨ã€ä¿¡æ¯è´¡çŒ®è€…ï¼Œç”šè‡³å…¨æ–°çš„ç«¯ç‚¹ï¼Œè®©Actuatoræ›´è´´åˆä½ çš„ä¸šåŠ¡éœ€æ±‚ã€‚

### 6.5.1 è‡ªå®šä¹‰å¥åº·æŒ‡ç¤ºå™¨ (`HealthIndicator`)

**åœºæ™¯**ï¼šä½ çš„åº”ç”¨ä¾èµ–ä¸€ä¸ªå¤–éƒ¨çš„ç¬¬ä¸‰æ–¹æ”¯ä»˜ç½‘å…³ã€‚ä½ å¸Œæœ›åº”ç”¨çš„`/health`çŠ¶æ€èƒ½åæ˜ è¿™ä¸ªæ”¯ä»˜ç½‘å…³çš„å¯ç”¨æ€§ã€‚

**å®ç°**ï¼šåˆ›å»ºä¸€ä¸ªå®ç°`HealthIndicator`æ¥å£çš„Beanã€‚

```java
import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

@Component
public class ExternalApiHealthIndicator implements HealthIndicator {

    @Override
    public Health health() {
        try {
            // æ¨¡æ‹Ÿè°ƒç”¨å¤–éƒ¨ API
            long startTime = System.currentTimeMillis();
            boolean isSuccess = checkExternalService();
            long duration = System.currentTimeMillis() - startTime;

            if (isSuccess) {
                // å¦‚æœæˆåŠŸï¼Œè¿”å› UP çŠ¶æ€ï¼Œå¹¶é™„å¸¦é¢å¤–ä¿¡æ¯ï¼ˆå¦‚å»¶è¿Ÿï¼‰
                return Health.up()
                        .withDetail("service", "Payment Gateway")
                        .withDetail("status", "Available")
                        .withDetail("latency", duration + "ms")
                        .build();
            } else {
                // å¦‚æœå¤±è´¥ï¼Œè¿”å› DOWN çŠ¶æ€
                return Health.down()
                        .withDetail("service", "Payment Gateway")
                        .withDetail("error", "Connection timeout")
                        .build();
            }
        } catch (Exception e) {
            return Health.down(e).withDetail("service", "Payment Gateway").build();
        }
    }

    private boolean checkExternalService() {
        // åœ¨è¿™é‡Œå®ç°å¯¹å¤–éƒ¨æœåŠ¡çš„çœŸå®æ£€æŸ¥é€»è¾‘ï¼Œä¾‹å¦‚å‘é€ä¸€ä¸ªå¿ƒè·³è¯·æ±‚
        // è¿™é‡Œæˆ‘ä»¬ç”¨ä¸€ä¸ªéšæœºæ•°æ¥æ¨¡æ‹ŸæˆåŠŸæˆ–å¤±è´¥
        return Math.random() > 0.2;
    }
}
```

ç°åœ¨ï¼Œå†æ¬¡è®¿é—®`/actuator/health`ï¼Œä½ ä¼šåœ¨`components`å­—æ®µä¸‹çœ‹åˆ°ä¸€ä¸ªåä¸º`externalApi`çš„æ–°æ¡ç›®ï¼Œå®ƒå®æ—¶åæ˜ äº†æ”¯ä»˜ç½‘å…³çš„å¥åº·çŠ¶å†µã€‚

### 6.5.2 è‡ªå®šä¹‰ä¿¡æ¯è´¡çŒ®è€… (`InfoContributor`)

**åœºæ™¯**ï¼šä½ å¸Œæœ›åœ¨`/info`ç«¯ç‚¹ä¸­åŠ¨æ€å±•ç¤ºåº”ç”¨å·²ç»è¿è¡Œäº†å¤šé•¿æ—¶é—´ã€‚

**å®ç°**ï¼šåˆ›å»ºä¸€ä¸ªå®ç°`InfoContributor`æ¥å£çš„Beanã€‚

```java
import org.springframework.boot.actuate.info.Info;
import org.springframework.boot.actuate.info.InfoContributor;
import org.springframework.stereotype.Component;
import java.time.Duration;
import java.lang.management.ManagementFactory;
import java.util.Map;

@Component
public class RuntimeInfoContributor implements InfoContributor {

    @Override
    public void contribute(Info.Builder builder) {
        long uptime = ManagementFactory.getRuntimeMXBean().getUptime();
        Duration uptimeDuration = Duration.ofMillis(uptime);
        builder.withDetail("runtime", Map.of(
            "uptime", uptimeDuration.toString(),
            "description", String.format("Uptime: %d days, %d hours, %d minutes",
                uptimeDuration.toDays(),
                uptimeDuration.toHoursPart(),
                uptimeDuration.toMinutesPart())
        ));
    }
}
```

è®¿é—®`/actuator/info`ï¼Œä½ å°†çœ‹åˆ°ä¸€ä¸ªåŒ…å«`runtime`ä¿¡æ¯çš„JSONå—ã€‚

### 6.5.3 åˆ›å»ºè‡ªå®šä¹‰ç«¯ç‚¹ (`@Endpoint`)

**åœºæ™¯**ï¼šä½ éœ€è¦ä¸€ä¸ªç®¡ç†æ¥å£æ¥æ‰‹åŠ¨è§¦å‘åº”ç”¨å†…çš„ç¼“å­˜åˆ·æ–°æ“ä½œã€‚

**å®ç°**ï¼šä½¿ç”¨`@Endpoint`, `@ReadOperation`, `@WriteOperation`, `@DeleteOperation`æ³¨è§£ã€‚

```java
import org.springframework.boot.actuate.endpoint.annotation.*;
import org.springframework.stereotype.Component;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

@Component
@Endpoint(id = "cache") // å®šä¹‰ç«¯ç‚¹çš„ ID
public class CacheEndpoint {

    private final Map<String, String> cacheStatus = new ConcurrentHashMap<>();

    public CacheEndpoint() {
        cacheStatus.put("users", "UP_TO_DATE");
        cacheStatus.put("products", "STALE");
    }

    // å¯¹åº” GET /actuator/cache
    @ReadOperation
    public Map<String, String> getCacheStatus() {
        return cacheStatus;
    }

    // å¯¹åº” POST /actuator/cache/{cacheName}
    @WriteOperation
    public void refreshCache(@Selector String cacheName) {
        // @Selector æ³¨è§£å°† URL ä¸­çš„ä¸€éƒ¨åˆ†ä½œä¸ºå‚æ•°
        // POST /actuator/cache/users
        System.out.println("Refreshing cache: " + cacheName);
        cacheStatus.put(cacheName, "REFRESHING");
        // ... å¼‚æ­¥æ‰§è¡Œåˆ·æ–°é€»è¾‘ ...
        // æ¨¡æ‹Ÿåˆ·æ–°å®Œæˆ
        cacheStatus.put(cacheName, "UP_TO_DATE");
    }

    // å¯¹åº” DELETE /actuator/cache
    @DeleteOperation
    public void clearAllCaches() {
        System.out.println("Clearing all caches...");
        cacheStatus.clear();
    }
}
```

**æ“ä½œä½ çš„æ–°ç«¯ç‚¹ï¼š**

- **æŸ¥çœ‹ç¼“å­˜çŠ¶æ€**: `curl http://localhost:8080/actuator/cache`
- **åˆ·æ–°ç”¨æˆ·ç¼“å­˜**: `curl -X POST http://localhost:8080/actuator/cache/users`
- **æ¸…ç©ºæ‰€æœ‰ç¼“å­˜**: `curl -X DELETE http://localhost:8080/actuator/cache`

> **ğŸ’¡ æç¤º**ï¼šè‡ªå®šä¹‰ç«¯ç‚¹ä¼šè‡ªåŠ¨é›†æˆSpring Securityã€‚ä½ å¯ä»¥åƒä¿æŠ¤åŸç”Ÿç«¯ç‚¹ä¸€æ ·ï¼Œé€šè¿‡`EndpointRequest.to("cache")`æ¥ä¸ºå®ƒé…ç½®å®‰å…¨è§„åˆ™ã€‚

---

## 6.6 ä¸ç›‘æ§ç³»ç»Ÿé›†æˆ

Actuatorçš„`/metrics`ç«¯ç‚¹æ˜¯æ•°æ®çš„æ¥æºï¼Œä½†è¦è®©è¿™äº›æ•°æ®çœŸæ­£äº§ç”Ÿä»·å€¼ï¼Œæˆ‘ä»¬éœ€è¦å°†å®ƒä»¬å­˜å‚¨ã€æŸ¥è¯¢å’Œå¯è§†åŒ–ã€‚**Prometheus + Grafana**æ˜¯å½“å‰ä¸šç•Œæœ€æµè¡Œçš„å¼€æºç›‘æ§ç»„åˆã€‚

- **Prometheus**: ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®åº“ï¼Œè´Ÿè´£å®šæœŸä»Actuatorçš„`/prometheus`ç«¯ç‚¹"æ‹‰å–"æŒ‡æ ‡æ•°æ®å¹¶å­˜å‚¨ã€‚
- **Grafana**: ä¸€ä¸ªå¼ºå¤§çš„å¯è§†åŒ–å¹³å°ï¼Œè´Ÿè´£æŸ¥è¯¢Prometheusä¸­çš„æ•°æ®ï¼Œå¹¶å°†å…¶ç»˜åˆ¶æˆå„ç§ç‚«é…·çš„å›¾è¡¨å’Œä»ªè¡¨ç›˜ã€‚

### æ­¥éª¤1ï¼šæ·»åŠ Prometheusä¾èµ–

åœ¨[pom.xml](file:///Users/yangzhao/Projects/IdeaProjects/springboot-learning/pom.xml)ä¸­æ·»åŠ `micrometer-registry-prometheus`ä¾èµ–ã€‚Micrometeræ˜¯Spring Boot 2.xå†…ç½®çš„æŒ‡æ ‡é—¨é¢ï¼Œå®ƒè´Ÿè´£å°†Actuatorçš„æŒ‡æ ‡è½¬æ¢ä¸ºPrometheusèƒ½ç†è§£çš„æ ¼å¼ã€‚

```xml
<dependency>
    <groupId>io.micrometer</groupId>
    <artifactId>micrometer-registry-prometheus</artifactId>
</dependency>
```

### æ­¥éª¤2ï¼šæš´éœ²`/prometheus`ç«¯ç‚¹

åœ¨`application.yml`ä¸­ï¼Œå°†`/prometheus`ç«¯ç‚¹æš´éœ²å‡ºæ¥ã€‚

```yaml
management:
  endpoints:
    web:
      exposure:
        include: "health,info,prometheus"
```

é‡å¯åº”ç”¨åï¼Œè®¿é—®`http://localhost:8080/actuator/prometheus`ï¼Œä½ å°†çœ‹åˆ°çº¯æ–‡æœ¬æ ¼å¼çš„æŒ‡æ ‡æ•°æ®ï¼Œè¿™å°±æ˜¯ä¸ºPrometheuså‡†å¤‡çš„"é¥²æ–™"ã€‚

### æ­¥éª¤3ï¼šé…ç½®Prometheus

ä¸‹è½½å¹¶å®‰è£…Prometheusã€‚åœ¨å…¶é…ç½®æ–‡ä»¶`prometheus.yml`ä¸­ï¼Œæ·»åŠ ä¸€ä¸ª`scrape_config`æ¥æŠ“å–ä½ çš„Spring Bootåº”ç”¨ã€‚

```yaml
scrape_configs:
  - job_name: 'spring-boot-app'
    metrics_path: '/actuator/prometheus' # æŒ‡å®šæŠ“å–è·¯å¾„
    static_configs:
      - targets: ['localhost:8080'] # æŒ‡å®šä½ çš„åº”ç”¨åœ°å€
```

å¯åŠ¨Prometheusï¼Œå®ƒå°±ä¼šå¼€å§‹å®šæœŸæ”¶é›†ä½ çš„åº”ç”¨æŒ‡æ ‡ã€‚

### æ­¥éª¤4ï¼šé…ç½®Grafana

1.  å®‰è£…å¹¶å¯åŠ¨Grafanaã€‚
2.  åœ¨Grafanaä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„**Prometheusæ•°æ®æº**ï¼ŒURLæŒ‡å‘ä½ çš„PrometheusæœåŠ¡å™¨ï¼ˆé»˜è®¤ä¸º`http://localhost:9090`ï¼‰ã€‚
3.  å¯¼å…¥ä¸€ä¸ªé¢„ç½®çš„Dashboardã€‚Spring Bootç¤¾åŒºå·²ç»ä¸ºæˆ‘ä»¬åˆ›å»ºäº†éå¸¸å®Œå–„çš„ä»ªè¡¨ç›˜ã€‚åœ¨Grafanaçš„"Dashboards / Import"é¡µé¢ï¼Œè¾“å…¥Dashboard ID`4701`ï¼ŒGrafanaå°±ä¼šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…å®ƒã€‚

å®Œæˆè¿™äº›æ­¥éª¤åï¼Œä½ å°†æ‹¥æœ‰ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Spring Bootåº”ç”¨ç›‘æ§å¤§ç›˜ï¼

---

## 6.7 å¯è§†åŒ–ç›‘æ§ï¼šé›†æˆ Spring Boot Admin

Spring Boot Adminæ˜¯ä¸€ä¸ªç¤¾åŒºé¡¹ç›®ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç®€æ´çš„Web UIï¼Œç”¨äºé›†ä¸­ç®¡ç†å’Œç›‘æ§å¤šä¸ªSpring Bootåº”ç”¨çš„Actuatorç«¯ç‚¹ã€‚å®ƒç‰¹åˆ«é€‚åˆä¸­å°å‹é¡¹ç›®æˆ–ä½œä¸ºPrometheusä½“ç³»çš„è½»é‡çº§è¡¥å……ã€‚

### æ¶æ„ï¼šServerä¸Client

- **Spring Boot Admin Server**: ä¸€ä¸ªç‹¬ç«‹çš„Spring Bootåº”ç”¨ï¼Œä½œä¸ºç›‘æ§ä¸­å¿ƒUIã€‚
- **Spring Boot Admin Client**: ä½ çš„ä¸šåŠ¡åº”ç”¨ï¼Œé€šè¿‡æ·»åŠ ä¸€ä¸ªå®¢æˆ·ç«¯ä¾èµ–ï¼Œå°†è‡ªå·±"æ³¨å†Œ"åˆ°Serverä¸Šã€‚

### æ­¥éª¤1ï¼šåˆ›å»ºAdmin Server

åˆ›å»ºä¸€ä¸ªæ–°çš„Spring Booté¡¹ç›®ï¼Œæ·»åŠ `spring-boot-admin-starter-server`ä¾èµ–ï¼Œå¹¶åœ¨ä¸»ç±»ä¸Šæ·»åŠ `@EnableAdminServer`æ³¨è§£ã€‚

**`pom.xml`:**
```xml
<dependency>
    <groupId>de.codecentric</groupId>
    <artifactId>spring-boot-admin-starter-server</artifactId>
    <version>2.7.4</version> <!-- ä½¿ç”¨åˆé€‚çš„ç‰ˆæœ¬ -->
</dependency>
```

**ä¸»ç±»:**
```java
@SpringBootApplication
@EnableAdminServer
public class AdminServerApplication {
    public static void main(String[] args) {
        SpringApplication.run(AdminServerApplication.class, args);
    }
}
```

### æ­¥éª¤2ï¼šé…ç½®ä¸šåŠ¡åº”ç”¨ä½œä¸ºClient

åœ¨ä½ éœ€è¦è¢«ç›‘æ§çš„Spring Booté¡¹ç›®ä¸­ï¼Œæ·»åŠ `spring-boot-admin-starter-client`ä¾èµ–ï¼Œå¹¶åœ¨`application.yml`ä¸­æŒ‡å®šAdmin Serverçš„åœ°å€ã€‚

**`pom.xml`:**
```xml
<dependency>
    <groupId>de.codecentric</groupId>
    <artifactId>spring-boot-admin-starter-client</artifactId>
    <version>2.7.4</version>
</dependency>
```

**`application.yml`:**
```yaml
spring:
  boot:
    admin:
      client:
        url: "http://localhost:8081" # Admin Server çš„åœ°å€
management:
  endpoints:
    web:
      exposure:
        include: "*" # Client éœ€è¦æš´éœ²ç«¯ç‚¹ç»™ Server
```

ç°åœ¨ï¼Œä¾æ¬¡å¯åŠ¨Admin Serverå’Œä½ çš„ä¸šåŠ¡åº”ç”¨ã€‚æ‰“å¼€Admin Serverçš„UIï¼ˆ`http://localhost:8081`ï¼‰ï¼Œä½ å°†çœ‹åˆ°ä½ çš„åº”ç”¨å·²ç»å‡ºç°åœ¨åˆ—è¡¨ä¸­ï¼Œä½ å¯ä»¥ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…ã€è°ƒæ•´æ—¥å¿—çº§åˆ«ã€æŸ¥çœ‹ç¯å¢ƒå±æ€§ç­‰ï¼Œéå¸¸ç›´è§‚ã€‚

---

## 6.8 æœ€ä½³å®è·µ

1.  **å®‰å…¨ç¬¬ä¸€**ï¼šæ°¸è¿œä¸è¦åœ¨å…¬ç½‘ä¸Šæš´éœ²æœªå—ä¿æŠ¤çš„Actuatorç«¯ç‚¹ã€‚ä¼˜å…ˆä½¿ç”¨**ç«¯å£éš”ç¦» + Spring Security**çš„é»„é‡‘ç»„åˆã€‚
2.  **æœ€å°æƒé™åŸåˆ™**ï¼šä½¿ç”¨`management.endpoints.web.exposure.include`ç²¾ç¡®åœ°åªæš´éœ²ä½ éœ€è¦çš„ç«¯ç‚¹ã€‚
3.  **è‡ªå®šä¹‰å¥åº·æ£€æŸ¥**ï¼šä¸ºä½ åº”ç”¨çš„æ‰€æœ‰å…³é”®ä¸‹æ¸¸ä¾èµ–ï¼ˆæ•°æ®åº“ã€ç¼“å­˜ã€ç¬¬ä¸‰æ–¹APIï¼‰åˆ›å»º`HealthIndicator`ã€‚
4.  **é›†æˆç‰ˆæœ¬ä¿¡æ¯**ï¼šé€šè¿‡`git-commit-id-plugin`å’Œ`build-info`è®©`/info`ç«¯ç‚¹æˆä¸ºä½ è¿½æº¯çº¿ä¸Šç‰ˆæœ¬çš„"èº«ä»½è¯"ã€‚
5.  **æ‹¥æŠ±ç›‘æ§ç”Ÿæ€**ï¼šå¯¹äºä¸¥è‚ƒçš„ç”Ÿäº§ç¯å¢ƒç›‘æ§ï¼Œä½¿ç”¨Actuator + Prometheus + Grafanaçš„ç»„åˆæ¥æ„å»ºä½“ç³»åŒ–çš„ç›‘æ§å’Œå‘Šè­¦ã€‚
6.  **åˆ©ç”¨Spring Boot Admin**ï¼šå¯¹äºå†…éƒ¨ç³»ç»Ÿæˆ–ä¸­å°å‹é¡¹ç›®ï¼ŒSpring Boot Adminæ˜¯ä¸€ä¸ªå¿«é€Ÿã€ä½æˆæœ¬çš„å¯è§†åŒ–ç›‘æ§é€‰æ‹©ã€‚

---

## 6.9 æ€»ç»“

Spring Boot Actuatoræ˜¯Spring Boot"ç”Ÿäº§å°±ç»ª"ç†å¿µçš„å®Œç¾ä½“ç°ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªå·¥å…·é›†ï¼Œæ›´æ˜¯ä¸€ç§å°†"å¯è§‚æµ‹æ€§"å†…å»ºäºåº”ç”¨ä¸­çš„è®¾è®¡å“²å­¦ã€‚é€šè¿‡Actuatorï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°æ‰“å¼€åº”ç”¨çš„"é»‘ç›’"ï¼Œæ´å¯Ÿå…¶å†…éƒ¨çš„æ¯ä¸€ä¸ªç»†èŠ‚ï¼Œä»è€Œæ„å»ºå‡ºæ›´å¥å£®ã€æ›´æ˜“äºç»´æŠ¤çš„ç³»ç»Ÿã€‚

### ğŸ“ æœ¬ç« è¦ç‚¹å›é¡¾

1. **Actuatoræ¦‚å¿µ**ï¼šåº”ç”¨ç›‘æ§çš„æ ¸å¿ƒå·¥å…·ï¼Œæä¾›å¥åº·æ£€æŸ¥ã€æ€§èƒ½æŒ‡æ ‡ç­‰åŠŸèƒ½
2. **æ ¸å¿ƒç«¯ç‚¹**ï¼šhealthã€infoã€metricsã€envã€loggersç­‰å…³é”®ç›‘æ§ç«¯ç‚¹
3. **é…ç½®ç®¡ç†**ï¼šç«¯ç‚¹æš´éœ²æ§åˆ¶å’Œå®‰å…¨ä¿æŠ¤æœºåˆ¶
4. **è‡ªå®šä¹‰æ‰©å±•**ï¼šå¥åº·æŒ‡ç¤ºå™¨ã€ä¿¡æ¯è´¡çŒ®è€…ã€è‡ªå®šä¹‰ç«¯ç‚¹çš„å®ç°æ–¹å¼
5. **ç›‘æ§é›†æˆ**ï¼šä¸Prometheusã€Grafanaã€Spring Boot Adminç­‰ç³»ç»Ÿçš„é›†æˆ
6. **æœ€ä½³å®è·µ**ï¼šç”Ÿäº§ç¯å¢ƒä¸­çš„å®‰å…¨é…ç½®å’Œä½¿ç”¨å»ºè®®

### ğŸ¯ å­¦ä¹ å»ºè®®

1. **åŠ¨æ‰‹å®è·µ**ï¼šåœ¨ç°æœ‰é¡¹ç›®ä¸­é›†æˆActuatorå¹¶å°è¯•å„ä¸ªç«¯ç‚¹
2. **ç†è§£åŸç†**ï¼šæ·±å…¥ç†è§£å„ä¸ªç«¯ç‚¹æä¾›çš„ä¿¡æ¯å«ä¹‰
3. **å®‰å…¨é…ç½®**ï¼šæŒæ¡ç”Ÿäº§ç¯å¢ƒä¸­çš„å®‰å…¨ä¿æŠ¤æªæ–½
4. **ç›‘æ§é›†æˆ**ï¼šå°è¯•é›†æˆPrometheuså’ŒGrafanaæ„å»ºå®Œæ•´çš„ç›‘æ§ä½“ç³»

### ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ 

- [7. Spring Boot éƒ¨ç½²](7.springboot-deploy.md)ï¼šå­¦ä¹ åº”ç”¨éƒ¨ç½²æ–¹å¼

> **ğŸ‰ æ­å–œï¼** ä½ å·²ç»æŒæ¡äº†Spring Boot Actuatorçš„æ ¸å¿ƒçŸ¥è¯†ï¼Œå¯ä»¥ä¸ºåº”ç”¨æ„å»ºå¼ºå¤§çš„ç›‘æ§ä½“ç³»äº†ï¼